<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit selected model to the specified seroprevalence survey data — fit_seromodel • serofoi</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit selected model to the specified seroprevalence survey data — fit_seromodel"><meta name="description" content="This function fits the specified model foi_model to the serological survey
data serodata by means of sampling. The
function determines whether the corresponding stan model object needs to be
compiled by rstan."><meta property="og:description" content="This function fits the specified model foi_model to the serological survey
data serodata by means of sampling. The
function determines whether the corresponding stan model object needs to be
compiled by rstan."><meta property="og:image" content="https://epiverse-trace.github.io/serofoi/logo.png"><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">serofoi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/serofoi.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/foi_models.html">An introduction to Force-of-Infection (FoI) Models</a></li>
    <li><a class="dropdown-item" href="../articles/use_cases.html">Real-life use cases for serofoi</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/serofoi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit selected model to the specified seroprevalence survey data</h1>
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/serofoi/blob/main/R/modelling.R" class="external-link"><code>R/modelling.R</code></a></small>
      <div class="d-none name"><code>fit_seromodel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function fits the specified model <code>foi_model</code> to the serological survey
data <code>serodata</code> by means of sampling. The
function determines whether the corresponding stan model object needs to be
compiled by rstan.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_seromodel</span><span class="op">(</span></span>
<span>  <span class="va">serodata</span>,</span>
<span>  foi_model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"constant"</span>, <span class="st">"tv_normal_log"</span>, <span class="st">"tv_normal"</span><span class="op">)</span>,</span>
<span>  foi_location <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  foi_scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  chunks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chunk_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  adapt_delta <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  max_treedepth <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">12345</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-serodata">serodata<a class="anchor" aria-label="anchor" href="#arg-serodata"></a></dt>
<dd><p>A data frame containing the data from a seroprevalence
survey. This data frame must contain at least the following columns:</p><dl><dt><code>total</code></dt>
<dd><p>Number of samples for each age group</p></dd>

<dt><code>counts</code></dt>
<dd><p>Number of positive samples for each age group</p></dd>

<dt><code>tsur</code></dt>
<dd><p>Year in which the survey took place</p></dd>

<dt><code>age_mean_f</code></dt>
<dd><p>Floor value of the average between age_min and age_max</p></dd>

<dt><code>sample_size</code></dt>
<dd><p>The size of the sample</p></dd>

<dt><code>birth_year</code></dt>
<dd><p>The year in which the individuals of each age group
were born</p></dd>


</dl><p>The last six columns can be added to <code>serodata</code> by means of the function
<code><a href="prepare_serodata.html">prepare_serodata()</a></code>.</p></dd>


<dt id="arg-foi-model">foi_model<a class="anchor" aria-label="anchor" href="#arg-foi-model"></a></dt>
<dd><p>Name of the selected model. Current version provides three
options:</p><dl><dt><code>"constant"</code></dt>
<dd><p>Runs a constant model</p></dd>

<dt><code>"tv_normal"</code></dt>
<dd><p>Runs a normal model</p></dd>

<dt><code>"tv_normal_log"</code></dt>
<dd><p>Runs a normal logarithmic model</p></dd>


</dl></dd>


<dt id="arg-foi-location">foi_location<a class="anchor" aria-label="anchor" href="#arg-foi-location"></a></dt>
<dd><p>Location parameter of the force-of-infection distribution
of the selected model. Depending on <code>foi_model</code>, the meaning may vary.</p></dd>


<dt id="arg-foi-scale">foi_scale<a class="anchor" aria-label="anchor" href="#arg-foi-scale"></a></dt>
<dd><p>Scale parameter of the force-of-infection distribution
of the selected model. Depending on <code>foi_model</code>, the meaning may vary.</p></dd>


<dt id="arg-chunks">chunks<a class="anchor" aria-label="anchor" href="#arg-chunks"></a></dt>
<dd><p>Numeric list specifying the chunk structure of the time
interval from the birth year of the oldest age cohort
<code>min(serodata$age_mean_f)</code> to the time when the serosurvey was conducted
<code>t_sur</code>. If <code>NULL</code>, the time interval is divided in chunks of size
<code>chunk_size</code>.</p></dd>


<dt id="arg-chunk-size">chunk_size<a class="anchor" aria-label="anchor" href="#arg-chunk-size"></a></dt>
<dd><p>Size of the chunks to be used in case that the chunk
structure <code>chunks</code> is not specified in fit_seromodel.
Default is 1, meaning that one force of infection value is to be estimated
for every year in the time interval spanned by the serosurvey.
If the length of the time interval is not exactly divisible by <code>chunk_size</code>,
the remainder years are included in the last chunk.</p></dd>


<dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>Number of interactions for each chain including the warmup.
<code>iter</code> in sampling.</p></dd>


<dt id="arg-adapt-delta">adapt_delta<a class="anchor" aria-label="anchor" href="#arg-adapt-delta"></a></dt>
<dd><p>Real number between 0 and 1 that represents the target
average acceptance probability. Increasing the value of <code>adapt_delta</code> will
result in a smaller step size and fewer divergences. For further details
refer to the <code>control</code> parameter in sampling or
<a href="https://mc-stan.org/rstanarm/reference/adapt_delta.html" class="external-link">here</a>.</p></dd>


<dt id="arg-max-treedepth">max_treedepth<a class="anchor" aria-label="anchor" href="#arg-max-treedepth"></a></dt>
<dd><p>Maximum tree depth for the binary tree used in the NUTS
stan sampler. For further details refer to the <code>control</code> parameter in
sampling.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>For further details refer to the <code>seed</code> parameter in
sampling.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters for sampling.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>seromodel_object</code>. <code>stanfit</code> object returned by the function
sampling</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">chagas2012</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">serodata</span> <span class="op">&lt;-</span> <span class="fu"><a href="prepare_serodata.html">prepare_serodata</a></span><span class="op">(</span><span class="va">chagas2012</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">seromodel_fit</span> <span class="op">&lt;-</span> <span class="fu">fit_seromodel</span><span class="op">(</span></span></span>
<span class="r-in"><span>  serodata <span class="op">=</span> <span class="va">serodata</span>,</span></span>
<span class="r-in"><span>  foi_model <span class="op">=</span> <span class="st">"constant"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zulma M. Cucunubá, Nicolás T. Domínguez, Ben Lambert, Pierre Nouvellet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

